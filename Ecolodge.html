<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Eco Lodge — Mohammad Fasahat</title>
  <meta name="description" content="Eco Lodge — a small ecolodge project." />
  <style>
    :root{
      --bg:#ffffff; --fg:#0b0d10; --muted:#6b7280; --accent:#111827;
      --max:1300px;
      --thumb-h:90px;
      --gap:20px;
    }
    *{box-sizing:border-box}
    body{ margin:0; font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; color:var(--fg); background:var(--bg); line-height:1.6; }
    a{ color:inherit; text-decoration:none }

    /* Canonical Header */
    header{ position:fixed; top:0; left:0; right:0; z-index:50; background:transparent; border:0 }
    .bar{ max-width:1300px; margin:0 auto; padding:14px 24px; display:flex; align-items:center; justify-content:space-between }
    .brand{ font-weight:700; font-size:18px }
    .brand-link{ color:var(--fg); text-decoration:none }
    .nav{ display:flex; gap:32px }
    .nav a{ font-size:18px; font-weight:600; padding:6px 8px; letter-spacing:0.02em; text-decoration:none; color:var(--fg) }
    @media (max-width:640px){ .nav a{ font-size:16px; padding:6px } }

    /* Page main */
    main{ max-width:var(--max); margin: 140px auto 80px; padding:0 24px; }

    /* Slideshow layout */
    .slideshow {
      display:flex;
      flex-direction:column;
      gap:var(--gap);
      align-items:center;
    }

    .viewer {
      width:100%;
      max-width:1100px;
      border-radius:6px;
      overflow:visible; /* allow arrows outside */
      position:relative;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    /* Main image: preserve ratio, limited by height */
    .viewer img {
      display:block;
      max-width:100%;
      width:auto;
      height:auto;
      max-height:76vh;          /* limit extreme tall images */
      border-radius:4px;
      box-shadow: none;
      background: transparent;
    }

    /* arrows */
    .arrow {
      position:absolute;
      top:50%;
      transform:translateY(-50%);
      width:40px; height:40px;
      border-radius:50%;
      background: rgba(0,0,0,0.04);
      display:grid;
      place-items:center;
      cursor:pointer;
      z-index:20;
      border:1px solid rgba(0,0,0,0.06);
    }
    .arrow:hover { background: rgba(0,0,0,0.06); }
    .arrow:active { transform:translateY(-50%) scale(.98); }
    .arrow.left { left:-18px; }
    .arrow.right{ right:-18px; }

    .arrow svg{ width:18px; height:18px; stroke:var(--fg); stroke-width:1.6; fill:none; }

    /* Thumbnails row (desktop & tablet) */
    .thumbs {
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:center;
      padding:6px 4px;
      width:100%;
      max-width:1100px;
      overflow:auto;
    }
    .thumb {
      flex:0 0 auto;
      width:130px;
      height:var(--thumb-h);
      border-radius:6px;
      overflow:hidden;
      border:1px solid #e8e8e8;
      display:block;
      cursor:pointer;
      background:#fff;
    }
    .thumb img{ width:100%; height:100%; object-fit:cover; display:block; }
    .thumb.active { outline:3px solid var(--accent); transform:translateY(-4px); transition:transform .18s ease; }

    /* Mobile: hide thumbs, show small dots */
    .dots {
      display:none;
      gap:8px;
      align-items:center;
      justify-content:center;
      margin-top:6px;
    }
    .dots button{ width:8px; height:8px; border-radius:50%; border:0; background:rgba(0,0,0,0.12); }
    .dots button.active{ background:var(--fg); }

    /* Info & copy (unchanged) */
    .info-row{ display:flex; gap:28px; margin-top:20px; align-items:flex-start; max-width:1100px; margin-left:auto; margin-right:auto; }
    .meta{ width:320px; flex:0 0 320px; background:#fafafa; border:1px solid #eee; padding:18px; border-radius:8px; }
    .meta h4{ margin:0 0 12px 0; font-size:13px; color:var(--muted); letter-spacing:.06em }
    .meta .kv{ display:flex; gap:10px; margin-bottom:10px; font-size:14px }
    .meta .kv span.key{ color:var(--muted); width:90px; font-size:13px }
    .text{ flex:1 1 auto; min-width:0; }

    .lead{ font-size:18px; margin:0 0 10px 0; font-weight:600 }
    .para{ color:var(--muted); margin:0 0 16px 0 }

    /* Responsive rules */
    @media (max-width:1000px){
      .viewer img{ max-height:66vh; }
      .thumbs{ gap:10px; }
      .thumb{ width:110px; height:78px; }
      .info-row{ flex-direction:column; gap:18px; }
    }

    /* Mobile portrait: hide thumbnails, enable dots */
    @media (max-width:640px){
      main { margin:120px 16px 60px; }
      .thumbs{ display:none; }
      .dots{ display:flex; }
      .viewer { max-width:100%; padding:0; }
      .viewer img { width:100%; height:auto; max-height:none; } /* use width-based layout; full-bleed-like */
      .arrow.left { left:6px; }
      .arrow.right { right:6px; }
    }

    /* small accessibility nicety for keyboard focus */
    .arrow:focus, .thumb:focus { outline: 3px solid rgba(0,0,0,0.08); outline-offset:4px; }
  </style>
</head>
<body>
  <header>
    <div class="bar">
      <a class="brand-link" href="index.html"><span class="brand">Mohammad Fasahat</span></a>
      <nav class="nav" aria-label="Primary">
        <a href="index.html#about">about</a>
        <a href="work.html">work</a>
        <a href="index.html#office">office</a>
      </nav>
    </div>
  </header>

  <main>
    <section class="slideshow" aria-label="Project slideshow">
      <div class="viewer" id="viewer">
        <button class="arrow left" id="prev" aria-label="Previous image">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M15 6l-6 6 6 6"/></svg>
        </button>

        <!-- main image -->
        <img id="mainImage" src="images/eco-1.jpg" alt="Eco Lodge main">

        <button class="arrow right" id="next" aria-label="Next image">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M9 6l6 6-6 6"/></svg>
        </button>
      </div>

      <!-- thumbnails (desktop / tablet) -->
      <div class="thumbs" id="thumbs" aria-hidden="false">
        <!-- thumbs will be injected by JS -->
      </div>

      <!-- mobile dots (only shown on small screens) -->
      <div class="dots" id="dots" aria-hidden="true"></div>
    </section>

    <!-- Info & copy -->
    <section class="info-row" aria-label="Project information and description">
      <aside class="meta" aria-labelledby="project-meta">
        <h4 id="project-meta">Project details</h4>
        <div class="kv"><span class="key">Project</span><span>Eco Lodge</span></div>
        <div class="kv"><span class="key">Typology</span><span>Hospitality / Ecolodge</span></div>
        <div class="kv"><span class="key">Location</span><span>— (edit location)</span></div>
        <div class="kv"><span class="key">Year</span><span>2025</span></div>
        <div class="kv"><span class="key">Status</span><span>Concept</span></div>
        <div class="kv"><span class="key">Size</span><span>— m²</span></div>
        <div class="kv"><span class="key">Client</span><span>— (private)</span></div>
        <div class="kv"><span class="key">Photography</span><span>Renderings</span></div>
      </aside>

      <div class="text">
        <div class="lead">A small ecolodge exploring low-impact construction and local craft.</div>
        <p class="para">Short intro — summarise the concept in 1–2 sentences. Replace this with your actual project summary.</p>
        <h3>Project description</h3>
        <p class="para">Longer narrative describing process, landscape strategy, material logic, and guest experience. Mention sustainability targets, community benefits, and spatial ideas.</p>
      </div>
    </section>
  </main>

  <script>
    // images to use (6 placeholders)
    const images = [
      'images/eco-1.jpg',
      'images/eco-2.jpg',
      'images/eco-3.jpg',
      'images/eco-4.jpg',
      'images/eco-5.jpg',
      'images/eco-6.jpg'
    ];

    const main = document.getElementById('mainImage');
    const thumbsContainer = document.getElementById('thumbs');
    const dotsContainer = document.getElementById('dots');
    const prevBtn = document.getElementById('prev');
    const nextBtn = document.getElementById('next');

    // read ?img= parameter
    function getUrlImgParam(){
      try { return new URL(location.href).searchParams.get('img'); } catch(e){ return null; }
    }

    // Build thumbs & dots
    let thumbs = [];
    images.forEach((src, i) => {
      // create thumb element
      const a = document.createElement('button');
      a.className = 'thumb';
      a.dataset.src = src;
      a.title = `View ${i+1}`;
      a.innerHTML = `<img src="${src}" alt="thumb ${i+1}">`;
      a.addEventListener('click', ()=> goTo(i));
      thumbsContainer.appendChild(a);
      thumbs.push(a);

      // dots for mobile
      const d = document.createElement('button');
      d.addEventListener('click', ()=> goTo(i));
      dotsContainer.appendChild(d);
    });

    const dotButtons = Array.from(dotsContainer.children);

    // helper to set active index
    let idx = 0;
    function setActive(newIndex){
      if(newIndex < 0) newIndex = images.length -1;
      if(newIndex >= images.length) newIndex = 0;
      idx = newIndex;

      main.src = images[idx];
      main.alt = `Eco Lodge — view ${idx+1}`;

      thumbs.forEach((t, i) => t.classList.toggle('active', i === idx));
      dotButtons.forEach((d, i) => d.classList.toggle('active', i === idx));

      // update URL with just filename so links can target specific view
      const u = new URL(location.href);
      u.searchParams.set('img', images[idx].split('/').pop());
      history.replaceState(null, '', u.toString());
    }

    // go to index
    function goTo(i){ setActive(i); scrollThumbIntoView(i); }

    // ensure clicked thumb is visible in scroller
    function scrollThumbIntoView(i){
      try {
        const t = thumbs[i];
        if(!t) return;
        t.scrollIntoView({behavior:'smooth', inline:'center', block:'nearest'});
      } catch(e){}
    }

    // init: decide starting index by ?img param
    (function init(){
      const param = getUrlImgParam();
      if(param){
        // find by filename
        const found = images.findIndex(s => s.endsWith(param) || s === param);
        if(found >= 0) { setActive(found); return; }
      }
      setActive(0);
    })();

    // arrows
    prevBtn.addEventListener('click', ()=> setActive(idx - 1));
    nextBtn.addEventListener('click', ()=> setActive(idx + 1));

    // keyboard navigation
    window.addEventListener('keydown', (e)=>{
      if(e.key === 'ArrowLeft') setActive(idx - 1);
      if(e.key === 'ArrowRight') setActive(idx + 1);
    });

    // simple swipe handlers for mobile
    (function swipe(){
      let startX = 0, startY = 0, started = false;
      const threshold = 40; // px

      const el = document.getElementById('viewer');
      el.addEventListener('touchstart', (ev) => {
        const t = ev.touches[0];
        startX = t.clientX; startY = t.clientY; started = true;
      }, {passive:true});
      el.addEventListener('touchmove', (ev) => {
        // prevent vertical scroll only when horizontal swipe detected (optional)
      }, {passive:true});
      el.addEventListener('touchend', (ev) => {
        if(!started) return;
        const t = ev.changedTouches[0];
        const dx = t.clientX - startX;
        const dy = t.clientY - startY;
        started = false;
        // ensure mostly horizontal
        if(Math.abs(dx) > Math.abs(dy) && Math.abs(dx) > threshold){
          if(dx < 0) setActive(idx + 1); else setActive(idx - 1);
        }
      }, {passive:true});
    })();

    // respond to popstate (back/forward)
    window.addEventListener('popstate', ()=>{
      const p = getUrlImgParam();
      if(p){
        const f = images.findIndex(s => s.endsWith(p) || s === p);
        if(f >= 0) setActive(f);
      } else {
        setActive(0);
      }
    });

    // show/hide dots' aria-hidden depending on viewport
    function updateDotsVisibility(){
      const mobile = window.matchMedia('(max-width:640px)').matches;
      dotsContainer.setAttribute('aria-hidden', !mobile);
      thumbsContainer.setAttribute('aria-hidden', mobile);
    }
    updateDotsVisibility();
    window.addEventListener('resize', updateDotsVisibility);
  </script>
</body>
</html>
